void 0;var pgen={canvas:null,context:null,targetWidth:512,targetHeight:512,downloadBtnActive:!1,logoPlacementAreaActive:!1,allowedFileTypes:["image/png","image/jpg","image/jpeg"],uploadedImage:null,selectedLogoPosition:"center",selectedBackgroundColor:"rgb(0,0,0)",selectedSticker:"logofull",imagePositions:{left:0,top:0,useWidth:0,useHeight:0},init:function(){void 0,this.canvas=document.getElementById("canvas"),this.context=canvas.getContext("2d"),this.watchSelectFromCollection(),this.watchSelectFromDisc(),this.watchDownloadRequest(),setTimeout(function(){pgen.resetCanvas(pgen.selectedBackgroundColor).setStartUpInfoImage(),setTimeout(function(){pgen.initColorPicker(),pgen.canvasToPreview()},1e3)})},initColorPicker:function(){new Picker({parent:document.getElementById("colorpick"),popup:!1,alpha:!1,editor:!1,color:this.fillColor,onDone:function(e){void 0,pgen.setBackgroundColor(e.rgbaString),pgen.toggleColorPicker(!1)}})},watchSelectFromDisc:function(){void 0,document.getElementById("ppicture_select").onchange=function(){void 0,pgen.checkAndUploadImage(this)}},watchDownloadRequest:function(){void 0,document.getElementById("downloadImageNow").onclick=function(){pgen.downloadImage(this)}},downloadImage:function(){void 0;var e=this.canvas.toDataURL("image/png"),t=document.createElement("a");document.body.appendChild(t),t.setAttribute("type","hidden");var o=e.replace(/data:image\/png;base64,/,"");t.href="data:image/png;base64,"+o,t.download="MoonX_Flavoured_ProfilePic.png",t.click(),document.body.removeChild(t)},checkAndUploadImage:function(e){void 0;var s=this;if(e.files&&e.files[0])if(-1<s.allowedFileTypes.indexOf(e.files[0].type.toLowerCase())){void 0;var t=new FileReader;t.onload=function(e){var g=new Image;g.onload=function(){var e=g.naturalWidth,t=g.naturalHeight,o=0,n=0;e<t?(n=t>s.targetHeight?s.targetHeight:t,o=e*(s.targetHeight/t)):(o=e>s.targetWidth?s.targetWidth:e,n=t*(s.targetWidth/e));var a=0,i=0;o<s.targetWidth&&(a=(s.targetWidth-o)/2),n<s.targetHeight&&(i=(s.targetHeight-n)/2),pgen.imagePositions.left=a,pgen.imagePositions.top=i,pgen.imagePositions.useWidth=o,pgen.imagePositions.useHeight=n,pgen.resetCanvas(pgen.selectedBackgroundColor),pgen.context.drawImage(g,a,i,o,n),pgen.addLogo(pgen.selectedLogoPosition).canvasToPreview()},g.src=e.target.result,pgen.uploadedImage=e.target.result,pgen.setDownloadButtonState(!1),pgen.setLogoPlacementAreaState(!0),pgen.smoothScrollTo("#previewArea")},t.readAsDataURL(e.files[0])}else void 0;else void 0},resetCanvas:function(e){e=e||pgen.selectedBackgroundColor;return this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.fillStyle=e,this.context.fillRect(0,0,this.canvas.width,this.canvas.height),this.canvasToPreview(),this},canvasToPreview:function(){var e=this.canvas.toDataURL("image/png");return $("#canvasPreview").attr("src",e),this},watchSelectFromCollection:function(){$(".from-collection").on("click",function(){var e=$(this).data("sticker");pgen.setSticker(e)})},setStartUpInfoImage:function(){var e=new Image;return e.onload=function(){pgen.context.drawImage(e,0,0)},e.src="img/firstSetimageInfo_version2.png",pgen.setDownloadButtonState(!1),pgen.setLogoPlacementAreaState(!1),this},addLogo:function(e){void 0;var t=new Image;return t.onload=function(){pgen.context.drawImage(t,0,0),pgen.canvasToPreview()},t.src="img/"+this.selectedSticker+"-"+e+".png",void 0,pgen.setDownloadButtonState(!0),pgen.setLogoPlacementAreaState(!0),this},setSticker:function(e){void 0,this.resetCanvas(pgen.selectedBackgroundColor);var t=new Image;null==pgen.uploadedImage&&(pgen.uploadedImage="img/blank-black-image.png"),pgen.selectedSticker=e,t.onload=function(){pgen.context.drawImage(t,pgen.imagePositions.left,pgen.imagePositions.top,pgen.imagePositions.useWidth,pgen.imagePositions.useHeight),pgen.addLogo(pgen.selectedLogoPosition),pgen.canvasToPreview()},t.src=pgen.uploadedImage,$(".from-collection-wrap").removeClass("active").promise().done(function(){void 0,$(".sticker-"+e).addClass("active")})},selectLogoPosition:function(e){void 0,this.resetCanvas(pgen.selectedBackgroundColor);var t=new Image;pgen.selectedLogoPosition=e,t.onload=function(){pgen.context.drawImage(t,pgen.imagePositions.left,pgen.imagePositions.top,pgen.imagePositions.useWidth,pgen.imagePositions.useHeight),pgen.addLogo(pgen.selectedLogoPosition),pgen.canvasToPreview()},t.src=pgen.uploadedImage,void 0},setBackgroundColor:function(e){void 0,pgen.selectedBackgroundColor=e,this.resetCanvas(pgen.selectedBackgroundColor);var t=new Image;t.onload=function(){pgen.context.drawImage(t,pgen.imagePositions.left,pgen.imagePositions.top,pgen.imagePositions.useWidth,pgen.imagePositions.useHeight),pgen.addLogo(pgen.selectedLogoPosition),pgen.canvasToPreview()},t.src=pgen.uploadedImage},setDownloadButtonState:function(e){return this.downloadBtnActive=e,this.checkDownloadButtonState(),this},checkDownloadButtonState:function(){return this.downloadBtnActive?$("#downloadButtonArea").fadeIn():$("#downloadButtonArea").fadeOut(),this},setLogoPlacementAreaState:function(e){return this.logoPlacementAreaActive=e,this.checkLogoPlacementAreaState(),this},checkLogoPlacementAreaState:function(){return this.logoPlacementAreaActive?$("#logoPlacementArea").fadeIn():$("#logoPlacementArea").fadeOut(),this},toggleColorPicker:function(e){return e?($("#colorPickerArea").fadeIn(),setTimeout(function(){var e=$("#previewArea");$("html, body").animate({scrollTop:e.offset().top+256},100)})):$("#colorPickerArea").fadeOut(),this},smoothScrollTo:function(t){setTimeout(function(){var e=$(t);$("html, body").animate({scrollTop:e.offset().top-50},100)})}};