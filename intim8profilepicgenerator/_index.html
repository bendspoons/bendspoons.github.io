<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Intim8 TG Image</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
    <meta name=viewport content="initial-scale=1">
    <style type="text/css">
      .ppicframe {
        width:512px;
        height: 512px;
        border-radius: 50%;
        border: 1px solid #333;
        margin: 0 auto 2em auto;
        //background-color: #b41e4b;
        //background-size: contain;
        background-repeat: no-repeat;
        background-position: center center;
        -webkit-box-shadow: 2px 2px 5px 0px #fa2000;
        -moz-box-shadow: 2px 2px 5px 0px #fa2000;
        box-shadow: 2px 2px 5px 0px #fa2000;
      }

      #ppicture_select {
        display: none;
      }

      .picker_sample, .picker_done {
        display: none;
      }

      /* https://cdn.jsdelivr.net/npm/reinvented-color-wheel@0.1.6/css/reinvented-color-wheel.min.css */
      .reinvented-color-wheel,.reinvented-color-wheel--hue-handle,.reinvented-color-wheel--hue-wheel,.reinvented-color-wheel--sv-handle,.reinvented-color-wheel--sv-space{touch-action:manipulation;touch-action:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.reinvented-color-wheel{position:relative;display:inline-block;line-height:0;border-radius:50%}.reinvented-color-wheel--hue-wheel{border-radius:50%}.reinvented-color-wheel--sv-space{position:absolute;left:0;top:0;right:0;bottom:0;margin:auto}.reinvented-color-wheel--hue-handle,.reinvented-color-wheel--sv-handle{position:absolute;box-sizing:border-box;pointer-events:none;border-radius:50%;border:2px solid #fff;box-shadow:inset 0 0 0 1px #000}#
    </style>
  </head>
  <body>

    <div class="container mt-4 text-center">

      <h2>Intim8 TG Profile Picture Generator</h2>

      <div class="mb-4">
        Just select and upload your profile picture, this tool merges it with our logo. Download it, set as profile picture - So much win!
      </div>

      <hr>

      <div class="mt-2">
        <div class="ppicframe" id="ppicframe">
          <img src="" alt="" id="ppicframe_overlay_img">
        </div>

        <div class="row justify-content-center">
          <div class="col align-self-center pb-2">
            <label class="btn btn btn-info" for="ppicture_select">Select profile picture (JPG, PNG)</label>
            <input type="file" name="ppicture_select" id="ppicture_select">
            <small class="text-muted form-text d-block">The optimal image is square, min. 512x512px (any other works too, void is filled with background color)</small>
          </div>
        </div>

        <div class="row justify-content-center">
          <div class="col align-self-center pb-2">
            <button class="btn btn-success" id="ppicture_save">Save generated Profile picture</button>
          </div>
        </div>

        <div class="row justify-content-center" style="display:none" id="ppicture_fillcolorswitchframe">
          <div class="col align-self-center pb-2 pt-4">
            <button class="btn btn btn-light" id="ppicture_fillcolorswitch">Change Fill/Background Color</button>
            <div id="colorpick" style="display:none;"></div>
          </div>
        </div>
      </div>

      <img src="" id="ppicframe_target_img" style="border: 1px solid #fa2000;width:512px;height:512px;display: none">

    </div>

    <script type="text/javascript">

      class PPToolbox {
        constructor() {
          this.fillColor = '#ffffff';

          this.logo = {
            'type'    : 'image/png',
            'width'   : 512,
            'height'  : 512,
            'src'     : 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAMAAADDpiTIAAAC+lBMVEUAAAD+///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////uNFL9Ap/+AUj+AEH9+vz3BaD+AFfzMVL+AXD+AWH0vM7+AU78ZsZASrEsNZs4hM/xSY1Fe8z+AX0/gM4vLJM4ULONTLvyCJrpNlN8V76FLquIJKL8AZYjSbDzUJSUJpFQdcmEUb0xitBYcMn/AIlmZcTv8fhMeM32P4n78/lsX8GxGopfa8ajvvd6wOgaXsN0W8CmHo4RdNn5SbuJPpP0+v356/OdQbaFS5n+ATjm5vGdIo9+OLX21OQqPqYFkfSVSLnqDqKCueN0Rb0fVLqIKZaONZEojNFTP6bpLU0Vac77W8CoO7OJndgIh+sE5+WQLYswI4iBT7PjDZV5s+DqQq98Lp2DWZIHnfoC9uD2ytoMfeKzNK+OkdWCpdwCqvvfGKbeN7LS4vL43+5NR7ZGN5kHtfLtoctYLZ2HZ473BW3eNFMJ2eiIr+BzptwGwfGjv+3xnbSNR7D2B10Czu56lM9gRbh0W6JpSZl8mdlxWbT3NrK8F47FwNuAe7tvv+eChcjPIKk6P6HkPoT0M4B2SMicPKpRM4rogaNjOY3A1u1erOyZiNPzB4Hf+fvY0uTqgsRRZcDpYrQjPaFsK5nfRWSNs/TxtdvBKKvlXY48YMEqxvF9arB3qew6HIDyBE1rNqKBc4OyyOn4H6ngWnT2InLkD1dHuPrkyeVCoeJXldTIOLRTW7HNEY83D3WXK6Hleo+xrNOzlsGegafTFZzfEG3zAjeay+Qw5NnC9/Yhh+NtiNcS7tZuU9SsKKSyTmzeEkPPotCeecPqK6B+bsVqcrmU7+txmOeXaHzJGHxWy+Y/heIrcdKYl8I8L434KI2hO4vBdK+2U6uAYoHFNWCfpc5ge82+sb9c7t5YYtmSebOZUpNPy3glAAAAIXRSTlMA+/ISGwnfJeh/ZYowttU7bcmVSnZdvlbPRKatm07EoFGOev2VAAAjfUlEQVR42uzBgQAAAACAoP2pF6kCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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'
          }

          this.picture = {
            'type'    : '',
            'width'   : 0,
            'height'  : 0,
            'src'     : ''
          }

          this.allowedFileTypes = ['image/png', 'image/jpg', 'image/jpeg'];
        }

        init() {
          //console.log('init');
          document.getElementById('ppicframe_overlay_img').src = this.logo.src

          var me = this;
          new Picker({
            parent: document.getElementById('colorpick'),
            popup: false,
            alpha: false,
            editor: false,
            color: me.fillColor,
            onChange: function(color) {
              //console.log('color', color)
              document.getElementById('ppicframe').style.backgroundColor = color.rgbaString;

              me.fillColor = color.rgbaString
            },
          });

          return this
        }

        reset() {
          //console.log('reset');
          document.getElementById('ppicture_save').style.display = 'none'
          document.getElementById('ppicture_fillcolorswitchframe').style.display = 'none'
          return this
        }

        resizeImage(width, height, maxWidth, maxHeight, ratio) {
          var newWidth = 0;
          var newHeight = 0;

          if (width > maxWidth && width > height) {
        	    ratio = width / height;
        	    newHeight = maxWidth/ratio;
        	    newWidth = maxWidth;
        	} else  if (height > maxHeight && height > width){
        	    ratio = height / width;
        	    newWidth = maxHeight/ratio;
        	    newHeight = maxHeight;
        	} else {
        	    newWidth = maxWidth;
        	    newHeight = maxHeight;
        	}

          if(width < maxWidth && height < newHeight) {
            newWidth = width;
            newHeight = height;
          }

          return {
            'width'  : newWidth,
            'height' : newHeight
          }
        }

        checkAndUploadImage(input) {
          //console.log('checkAndUploadImage', input);

          var me = this;
          if (input.files && input.files[0]) {
            //console.log('input.files', input.files[0]);

            if(me.allowedFileTypes.indexOf(input.files[0].type.toLowerCase()) > -1) {
              var reader = new FileReader();

              reader.onload = function (e) {
                document.getElementById('ppicframe').style.backgroundImage  = 'url(' + e.target.result + ')'

                me.picture.type = input.files[0].type.toLowerCase();
                me.picture.src = e.target.result;

                var tmpImg = new Image();
                tmpImg.src = e.target.result
                tmpImg.onload = function() {
                  me.picture.width = tmpImg.naturalWidth;
                  me.picture.height = tmpImg.naturalHeight;

                  //console.log('me.picture.width', me.picture.width);
                  //console.log('me.picture.height', me.picture.height);

                  //console.log('me.logo.width', me.logo.width);
                  //console.log('me.logo.height', me.logo.height);

                  var resized = me.resizeImage(me.picture.width, me.picture.height, me.logo.width, me.logo.height, 0);
                  //console.log('me.resizeImage', resized);

                  me.picture.width = resized.width;
                  me.picture.height = resized.height;

                  document.getElementById('ppicture_save').style.display = 'inline-block'
                  document.getElementById('ppicture_fillcolorswitchframe').style.display = 'inline-block'
                  document.getElementById('ppicframe').style.backgroundSize = resized.width + 'px ' + resized.height + 'px'

                  //console.log('me.picture.type', me.picture.type);
                  //console.log('me.picture.src', me.picture.src);

                  tmpImg = null;
                };

              }

              reader.readAsDataURL(input.files[0]);
            } else {
              alert('Sorry, only JPG and PNG files are allowed')
            }
          }
        }

        generateFinalImage() {
          //console.log('generateFinalImage');
          //console.log('this.picture.src', this.picture.src);
          //console.log('this.logo.src', this.logo.src);

          var me = this;

          var canvas = document.createElement("canvas");
          canvas.width = 512;
          canvas.height = 512;
          var context = canvas.getContext("2d");
          context.beginPath();
          context.arc(256, 256, 256, 0, 2 * Math.PI);
          context.clip();
          context.stroke();

          context.rect(0 , 0 , canvas.width , canvas.height);
          //context.fillStyle = "#b41e4b";
          context.fillStyle = me.fillColor;
          context.fill();

          var myImage = new Image();
          myImage.src = me.picture.src;
          myImage.crossOrigin = 'Anonymous';

          myImage.onload = function() {
            var width = me.picture.width;
            var height = me.picture.height;
            var left = ((512 - width) / 2);
            var top = ((512 - height) / 2);

            context.drawImage(myImage, left, top, width, height);

            var myImage2 = new Image();
            myImage2.src = me.logo.src; // Your own local or online photos
            myImage2.crossOrigin = 'Anonymous';

            myImage2.onload = function(){
              context.drawImage(myImage2, 0, 0, 512, 512);
              var base64 = canvas.toDataURL ("image/png"); //"image/png" here note
              var img = document.getElementById('ppicframe_target_img');

              img.setAttribute('src' , base64);

              var link = document.createElement("a");
              document.body.appendChild(link);
              link.setAttribute("type", "hidden");

              //console.log('base64', base64);
              var partial = base64.replace(/data:image\/png;base64,/, "")
              //console.log('partial', partial);

              link.href = "data:image/png;base64," + partial;
              link.download = "Intim8_Flavoured_ProfilePic.png";
              link.click();
              document.body.removeChild(link);
            }
          }
        }
      }

      var app = null;
      document.addEventListener("DOMContentLoaded", function(event) {
        app = new PPToolbox();
        app.init().reset();

        document.getElementById('ppicture_select').onchange = function() {
          app.checkAndUploadImage(this)
        }

        document.getElementById('ppicture_save').onclick = function() {
          app.generateFinalImage()
        }

        document.getElementById('ppicture_fillcolorswitch').onclick = function() {
          document.getElementById('colorpick').style.display = 'block';
        }
      });
      </script>

      <script>
      /*!
      * vanilla-picker v2.2.1
      * https://github.com/Sphinxxxx/vanilla-picker
      *
      * Copyright 2017-2018 Andreas Borgen (https://github.com/Sphinxxxx), Adam Brooks (https://github.com/dissimulate)
      * Released under the ISC license.
      */(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?module.exports=factory():typeof define==='function'&&define.amd?define(factory):(global.Picker=factory());}(this,(function(){'use strict';var classCallCheck=function(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}};var createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
      return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"])_i["return"]();}finally{if(_d)throw _e;}}
      return _arr;}
      return function(arr,i){if(Array.isArray(arr)){return arr;}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i);}else{throw new TypeError("Invalid attempt to destructure non-iterable instance");}};}();String.prototype.startsWith=String.prototype.startsWith||function(needle){return this.indexOf(needle)===0;};String.prototype.padStart=String.prototype.padStart||function(len,pad){var str=this;while(str.length<len){str=pad+str;}return str;};var colorNames='735AACA770//Xub218Pj/mo5+uvX6mdAP//gtpf//Ur258P//q1d9fXcxop/+TEq9zAAAAqfg/+vN6m1AAD/ngoiiviqt6pSoqzyo3riHxvdX56grk1f/8Aax10mkeqts/39QxbtZJXttkb//jcyxm3BQ86rmAP//wl5AACLwqqAIuL3y8uIYLwv1qampniqAGQAns5vbdrmohiwCLw5uVWsvsdd/4wAsegmTLMqagiwAAsqi6ZZ6uz6j7yPxtzSD2Lxk3L09PudbAM7RwsolADT0kz/xSTfuhAL//vfhaWlpyuxHpD/43rsiIiwn9//rw39uIosi9bp/wD/6w73Nzc9s5+Pj/6v8/9cA3b42qUg6vxgICArmaAIAAtdfrf8vf9n8P/wek3/2m0xnczVxc3bvSwCCsdt///wrvp8OaMs5i5ub6iyk//D1e8ifPwAoui//rNpyxrdjmw9c8ICAq4i4P//mx9+vrSq8t09PTx1ukO6Qqlv/7bBuuy/6B690uILKqpfdh876sd9d4iZnehsMTe0dv///g71lAP8A4nmMs0ys9u+vDmg9d/wD/4pmgAAAcurZs2qzllAADN4lkulXT6txk3Db66qPLNxozre2juokuAPqalj3SNHMgdkxxWF60pGRlwxfl9f/6hr5/+Thx6q/+S1m85/96tutd/fXmszxgIAAe4ma44j8rl/6UAmu0/0UA8so2nDWji87uiqumqmPuY9xbr+7u4rs23CTsb8/+/V95a/9q577xzYU/78z/8DL7b53aDdsu1sODmb11gACAy5nZjOZ1so/wAAlvevI+Pn09QWnhm7ui0UT94q+oBy7ei9KRg5aqLotXad5oFItasmwMDAaihh87r9fdalrN9p9cICQ7gz//r6k5uAP9/4qhRoK01te0rSM7cwAICA91x2L/Yclr/2NHcw1QODQd6w7oLuua09d6zudh////t359fX1enn//8Ao0ims0y';var colorNamesDeser=void 0;var Color=function(){function Color(r,g,b,a){classCallCheck(this,Color);var that=this;function parseString(input){if(input.startsWith('hsl')){var _input$match$map=input.match(/([\-\d\.e]+)/g).map(Number),_input$match$map2=slicedToArray(_input$match$map,4),h=_input$match$map2[0],s=_input$match$map2[1],l=_input$match$map2[2],_a=_input$match$map2[3];if(_a===undefined){_a=1;}
      h/=360;s/=100;l/=100;that.hsla=[h,s,l,_a];}
      else if(input.startsWith('rgb')){var _input$match$map3=input.match(/([\-\d\.e]+)/g).map(Number),_input$match$map4=slicedToArray(_input$match$map3,4),_r=_input$match$map4[0],_g=_input$match$map4[1],_b=_input$match$map4[2],_a2=_input$match$map4[3];if(_a2===undefined){_a2=1;}
      that.rgba=[_r,_g,_b,_a2];}
      else{if(input.startsWith('#')){that.rgba=Color.hexToRgb(input);}else{that.rgba=Color.nameToRgb(input)||Color.hexToRgb(input);}}}
      if(r===undefined);else if(Array.isArray(r)){this.rgba=r;}
      else if(b===undefined){var color=r&&(''+r).trim();if(color){parseString(color.toLowerCase());}}else{this.rgba=[r,g,b,a===undefined?1:a];}}
      createClass(Color,[{key:'rgba',get:function get$$1(){if(this._rgba){return this._rgba;}
      if(!this._hsla){throw new Error('No color is set');}
      return this._rgba=Color.hslToRgb(this._hsla);},set:function set$$1(rgb){if(rgb.length===3){rgb[3]=1;}
      this._rgba=rgb;this._hsla=null;}},{key:'rgbString',get:function get$$1(){return 'rgb('+this.rgba.slice(0,3)+')';}},{key:'rgbaString',get:function get$$1(){return 'rgba('+this.rgba+')';}},{key:'hsla',get:function get$$1(){if(this._hsla){return this._hsla;}
      if(!this._rgba){throw new Error('No color is set');}
      return this._hsla=Color.rgbToHsl(this._rgba);},set:function set$$1(hsl){if(hsl.length===3){hsl[3]=1;}
      this._hsla=hsl;this._rgba=null;}},{key:'hslString',get:function get$$1(){var c=this.hsla;return 'hsl('+c[0]*360+','+c[1]*100+'%,'+c[2]*100+'%)';}},{key:'hslaString',get:function get$$1(){var c=this.hsla;return 'hsla('+c[0]*360+','+c[1]*100+'%,'+c[2]*100+'%,'+c[3]+')';}},{key:'hex',get:function get$$1(){var rgb=this.rgba,hex=rgb.map(function(x,i){return i<3?x.toString(16):Math.round(x*255).toString(16);});return '#'+hex.map(function(x){return x.padStart(2,'0');}).join('');},set:function set$$1(hex){this.rgba=Color.hexToRgb(hex);}}],[{key:'hexToRgb',value:function hexToRgb(input){var hex=(input.startsWith('#')?input.slice(1):input).replace(/^(\w{3})$/,'$1F').replace(/^(\w)(\w)(\w)(\w)$/,'$1$1$2$2$3$3$4$4').replace(/^(\w{6})$/,'$1FF');if(!hex.match(/^([0-9a-fA-F]{8})$/)){throw new Error('Unknown hex color; '+input);}
      var rgba=hex.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map(function(x){return parseInt(x,16);});rgba[3]=rgba[3]/255;return rgba;}},{key:'nameToRgb',value:function nameToRgb(input){if(!colorNamesDeser){colorNamesDeser={};colorNames.match(/.{7}/g).forEach(function(x){return colorNamesDeser[x.slice(0,3)]=atob(x.slice(-4)).split('').map(function(b){return b.charCodeAt(0);});});}
      var hash=[].reduce.call(input.replace('ey','ay'),function(h,c){return(h<<2)+c.charCodeAt(0);},0).toString(36).slice(-3);return colorNamesDeser[hash];}},{key:'rgbToHsl',value:function rgbToHsl(_ref){var _ref2=slicedToArray(_ref,4),r=_ref2[0],g=_ref2[1],b=_ref2[2],a=_ref2[3];r/=255;g/=255;b/=255;var max=Math.max(r,g,b),min=Math.min(r,g,b);var h=void 0,s=void 0,l=(max+min)/2;if(max===min){h=s=0;}else{var d=max-min;s=l>0.5?d/(2-max-min):d/(max+min);switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break;}
      h/=6;}
      return[h,s,l,a];}},{key:'hslToRgb',value:function hslToRgb(_ref3){var _ref4=slicedToArray(_ref3,4),h=_ref4[0],s=_ref4[1],l=_ref4[2],a=_ref4[3];var r=void 0,g=void 0,b=void 0;if(s===0){r=g=b=l;}else{var hue2rgb=function hue2rgb(p,q,t){if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q-p)*6*t;if(t<1/2)return q;if(t<2/3)return p+(q-p)*(2/3-t)*6;return p;};var q=l<0.5?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3);g=hue2rgb(p,q,h);b=hue2rgb(p,q,h-1/3);}
      var rgba=[r*255,g*255,b*255].map(Math.round);rgba[3]=a;return rgba;}}]);return Color;}();var root=window;function dragTracker(options){var ep=Element.prototype;if(!ep.matches)ep.matches=ep.msMatchesSelector||ep.webkitMatchesSelector;if(!ep.closest)ep.closest=function(s){var node=this;do{if(node.matches(s))return node;node=node.tagName==='svg'?node.parentNode:node.parentElement;}while(node);return null;};options=options||{};var container=options.container||document.documentElement,selector=options.selector,callback=options.callback||console.log,callbackStart=options.callbackDragStart,callbackEnd=options.callbackDragEnd,callbackClick=options.callbackClick,propagate=options.propagateEvents,roundCoords=options.roundCoords!==false,dragOutside=options.dragOutside!==false,handleOffset=options.handleOffset||options.handleOffset!==false;var offsetToCenter=null;switch(handleOffset){case 'center':offsetToCenter=true;break;case 'topleft':case 'top-left':offsetToCenter=false;break;}
      var dragState=void 0;function getMousePos(e,elm,offset,stayWithin){var x=e.clientX,y=e.clientY;function respectBounds(value,min,max){return Math.max(min,Math.min(value,max));}
      if(elm){var bounds=elm.getBoundingClientRect();x-=bounds.left;y-=bounds.top;if(offset){x-=offset[0];y-=offset[1];}
      if(stayWithin){x=respectBounds(x,0,bounds.width);y=respectBounds(y,0,bounds.height);}
      if(elm!==container){var center=offsetToCenter!==null?offsetToCenter:elm.nodeName==='circle'||elm.nodeName==='ellipse';if(center){x-=bounds.width/2;y-=bounds.height/2;}}}
      return roundCoords?[Math.round(x),Math.round(y)]:[x,y];}
      function stopEvent(e){e.preventDefault();if(!propagate){e.stopPropagation();}}
      function onDown(e){var target=void 0;if(selector){target=selector instanceof Element?selector.contains(e.target)?selector:null:e.target.closest(selector);}else{target={};}
      if(target){stopEvent(e);var mouseOffset=selector&&handleOffset?getMousePos(e,target):[0,0],startPos=getMousePos(e,container,mouseOffset);dragState={target:target,mouseOffset:mouseOffset,startPos:startPos,actuallyDragged:false};if(callbackStart){callbackStart(target,startPos);}}}
      function onMove(e){if(!dragState){return;}
      stopEvent(e);var start=dragState.startPos,pos=getMousePos(e,container,dragState.mouseOffset,!dragOutside);dragState.actuallyDragged=dragState.actuallyDragged||start[0]!==pos[0]||start[1]!==pos[1];callback(dragState.target,pos,start);}
      function onEnd(e,cancelled){if(!dragState){return;}
      if(callbackEnd||callbackClick){var isClick=!dragState.actuallyDragged,pos=isClick?dragState.startPos:getMousePos(e,container,dragState.mouseOffset,!dragOutside);if(callbackClick&&isClick&&!cancelled){callbackClick(dragState.target,pos);}
      if(callbackEnd){callbackEnd(dragState.target,pos,dragState.startPos,cancelled||isClick&&callbackClick);}}
      dragState=null;}
      addEvent(container,'mousedown',function(e){if(isLeftButton(e)){onDown(e);}else{onEnd(e,true);}});addEvent(container,'touchstart',function(e){return relayTouch(e,onDown);});addEvent(root,'mousemove',function(e){if(!dragState){return;}
      if(isLeftButton(e)){onMove(e);}
      else{onEnd(e);}});addEvent(root,'touchmove',function(e){return relayTouch(e,onMove);});addEvent(container,'mouseup',function(e){if(dragState&&!isLeftButton(e)){onEnd(e);}});function onTouchEnd(e,cancelled){onEnd(tweakTouch(e),cancelled);}
      addEvent(container,'touchend',function(e){return onTouchEnd(e);});addEvent(container,'touchcancel',function(e){return onTouchEnd(e,true);});function addEvent(target,type,handler){target.addEventListener(type,handler);}
      function isLeftButton(e){return e.buttons!==undefined?e.buttons===1:e.which===1;}
      function relayTouch(e,handler){if(e.touches.length!==1){onEnd(e,true);return;}
      handler(tweakTouch(e));}
      function tweakTouch(e){var touch=e.targetTouches[0];if(!touch){touch=e.changedTouches[0];}
      touch.preventDefault=e.preventDefault.bind(e);touch.stopPropagation=e.stopPropagation.bind(e);return touch;}}
      function parseHTML(htmlString){var div=document.createElement('div');div.innerHTML=htmlString;return div.firstElementChild;}
      function addEvent(target,type,handler){target.addEventListener(type,handler,false);}
      var BG_TRANSP='url("data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'2\' height=\'2\'%3E%3Cpath d=\'M1,0H0V1H2V2H1\' fill=\'lightgrey\'/%3E%3C/svg%3E")';var HUES=360;document.documentElement.firstElementChild.appendChild(document.createElement('style')).textContent='.picker_wrapper.no_alpha .picker_alpha,.picker_wrapper.no_editor .picker_editor{display:none}.layout_default.picker_wrapper{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:stretch;font-size:10px;width:25em;padding:.5em;margin: 0 auto !important;}.layout_default.picker_wrapper input,.layout_default.picker_wrapper button{font-size:1rem}.layout_default.picker_wrapper>*{margin:.5em}.layout_default.picker_wrapper::before{content:\'\';display:block;width:100%;height:0;order:1}.layout_default .picker_slider,.layout_default .picker_selector{padding:1em}.layout_default .picker_hue{width:100%}.layout_default .picker_sl{flex:1 1 auto}.layout_default .picker_sl::before{content:\'\';display:block;padding-bottom:100%}.layout_default .picker_editor{order:1;width:6rem}.layout_default .picker_editor input{width:calc(100% + 2px);height:calc(100% + 2px)}.layout_default .picker_sample{order:1;flex:1 1 auto}.layout_default .picker_done{order:1}.picker_wrapper{box-sizing:border-box;background:#f2f2f2;cursor:default;font-family:sans-serif;pointer-events:auto}.picker_wrapper button,.picker_wrapper input{margin:-1px}.picker_selector{position:absolute;z-index:1;display:block;transform:translate(-50%, -50%);border:2px solid white;border-radius:100%;box-shadow:0 0 3px 1px #67b9ff;background:currentColor;cursor:pointer}.picker_slider .picker_selector{border-radius:2px}.picker_hue{position:relative;background-image:linear-gradient(90deg, red, yellow, lime, cyan, blue, magenta, red);box-shadow:0 0 0 1px silver}.picker_sl{position:relative;box-shadow:0 0 0 1px silver;background-image:linear-gradient(180deg, white, rgba(255,255,255,0) 50%),linear-gradient(0deg, black, rgba(0,0,0,0) 50%),linear-gradient(90deg, gray, rgba(128,128,128,0))}.picker_alpha,.picker_sample{position:relative;background:url("data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'2\' height=\'2\'%3E%3Cpath d=\'M1,0H0V1H2V2H1\' fill=\'lightgrey\'/%3E%3C/svg%3E") left top/contain white;box-shadow:0 0 0 1px silver}.picker_alpha .picker_selector,.picker_sample .picker_selector{background:none}.picker_editor input{box-sizing:border-box;font-family:monospace;padding:.1em .2em}.picker_sample::before{content:\'\';position:absolute;display:block;width:100%;height:100%;background:currentColor}.picker_done button{box-sizing:border-box;padding:.2em .5em;cursor:pointer}.picker_arrow{position:absolute;z-index:-1}.picker_wrapper.popup{position:absolute;z-index:2;margin:1.5em}.picker_wrapper.popup,.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{background:#f2f2f2;box-shadow:0 0 10px 1px rgba(0,0,0,0.4)}.picker_wrapper.popup .picker_arrow{width:3em;height:3em;margin:0}.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{content:"";display:block;position:absolute;top:0;left:0;z-index:-99}.picker_wrapper.popup .picker_arrow::before{width:100%;height:100%;transform:skew(45deg);transform-origin:0 100%}.picker_wrapper.popup .picker_arrow::after{width:150%;height:150%;box-shadow:none}.popup.popup_top{bottom:100%;left:0}.popup.popup_top .picker_arrow{bottom:0;left:0;transform:rotate(-90deg)}.popup.popup_bottom{top:100%;left:0}.popup.popup_bottom .picker_arrow{top:0;left:0;transform:rotate(90deg) scale(1, -1)}.popup.popup_left{top:0;right:100%}.popup.popup_left .picker_arrow{top:0;right:0;transform:scale(-1, 1)}.popup.popup_right{top:0;left:100%}.popup.popup_right .picker_arrow{top:0;left:0}';var Picker=function(){function Picker(options){classCallCheck(this,Picker);this.settings={popup:'right',layout:'default',alpha:true,editor:true};this.setOptions(options);}
      createClass(Picker,[{key:'setOptions',value:function setOptions(options){var _this=this;if(!options){return;}
      var settings=this.settings;function transfer(source,target,skipKeys){for(var key in source){if(skipKeys&&skipKeys.indexOf(key)>=0){continue;}
      target[key]=source[key];}}
      if(options instanceof HTMLElement){settings.parent=options;}else{transfer(options,settings);}
      if(options.onChange){this.onChange=options.onChange;}
      if(options.onDone){this.onDone=options.onDone;}
      var col=options.color||options.colour;if(col){this._setColor(col);}
      if(settings.parent&&settings.popup&&!this._popupInited){addEvent(settings.parent,'click',function(e){return _this.openHandler(e);});this._popupInited=true;}else if(options.parent&&!settings.popup){this.show();}}},{key:'openHandler',value:function openHandler(e){this.show();this.settings.parent.style.pointerEvents='none';}},{key:'closeHandler',value:function closeHandler(e){var doHide=false;if(e.type==='mousedown'){if(!this.domElement.contains(e.target)){doHide=true;}}
      else{e.preventDefault();e.stopPropagation();doHide=true;}
      if(doHide){this.hide();this.settings.parent.style.pointerEvents='';}}},{key:'setColor',value:function setColor(color){this._setColor(color);}},{key:'_setColor',value:function _setColor(color,fromEditor){var c=new Color(color);if(!this.settings.alpha){var hsla=c.hsla;hsla[3]=1;c.hsla=hsla;}
      this.colour=this.color=c;this._setHSLA(null,null,null,null,fromEditor);}},{key:'setColour',value:function setColour(colour){this.setColor(colour);}},{key:'show',value:function show(){var parent=this.settings.parent;if(!parent){return;}
      if(this.domElement){this.domElement.style.display='';this._setPosition();return;}
      var html=this.settings.template||'<div class="picker_wrapper"><div class="picker_arrow"></div><div class="picker_hue picker_slider"><div class="picker_selector"></div></div><div class="picker_sl"><div class="picker_selector"></div></div><div class="picker_alpha picker_slider"><div class="picker_selector"></div></div><div class="picker_editor"><input/></div><div class="picker_sample"></div><div class="picker_done"><button>Ok</button></div></div>';var wrapper=parseHTML(html);this.domElement=wrapper;this._domH=wrapper.querySelector('.picker_hue');this._domSL=wrapper.querySelector('.picker_sl');this._domA=wrapper.querySelector('.picker_alpha');this._domEdit=wrapper.querySelector('.picker_editor input');this._domSample=wrapper.querySelector('.picker_sample');this._domOkay=wrapper.querySelector('.picker_done button');wrapper.classList.add('layout_'+this.settings.layout);if(!this.settings.alpha){wrapper.classList.add('no_alpha');}
      if(!this.settings.editor){wrapper.classList.add('no_editor');}
      this._ifPopup(function(){return wrapper.classList.add('popup');});this._setPosition();if(this.colour){this._updateUI();}else{this._setColor('#0cf');}
      this._bindEvents();}},{key:'hide',value:function hide(){if(this.domElement){this.domElement.style.display='none';}}},{key:'_bindEvents',value:function _bindEvents(){var _this2=this;var that=this;function createDragConfig(container,callbackRelative){function relayDrag(_,pos){var relX=pos[0]/container.clientWidth,relY=pos[1]/container.clientHeight;callbackRelative(relX,relY);}
      var config={container:container,dragOutside:false,callback:relayDrag,callbackClick:relayDrag,callbackDragStart:relayDrag,propagateEvents:true};return config;}
      dragTracker(createDragConfig(this._domH,function(x,y){return that._setHSLA(x);}));dragTracker(createDragConfig(this._domSL,function(x,y){return that._setHSLA(null,x,1-y);}));if(this.settings.alpha){dragTracker(createDragConfig(this._domA,function(x,y){return that._setHSLA(null,null,null,1-y);}));}
      if(this.settings.editor){addEvent(this._domEdit,'input',function(e){var color=this.value;try{new Color(this.value);that._setColor(color,true);}catch(ex){}});}
      addEvent(window,'mousedown',function(e){return _this2._ifPopup(function(){return _this2.closeHandler(e);});});addEvent(this._domOkay,'click',function(e){_this2._ifPopup(function(){return _this2.closeHandler(e);});if(_this2.onDone){_this2.onDone(_this2.colour);}});}},{key:'_setPosition',value:function _setPosition(){var parent=this.settings.parent,elm=this.domElement;if(parent!==elm.parentNode){parent.appendChild(elm);}
      this._ifPopup(function(popup){if(getComputedStyle(parent).position==='static'){parent.style.position='relative';}
      var cssClass=popup===true?'popup_right':'popup_'+popup;['popup_top','popup_bottom','popup_left','popup_right'].forEach(function(c){if(c===cssClass){elm.classList.add(c);}else{elm.classList.remove(c);}});elm.classList.add(cssClass);});}},{key:'_setHSLA',value:function _setHSLA(h,s,l,a,fromEditor){var col=this.colour;var hsla=col.hsla;[h,s,l,a].forEach(function(x,i){if(x||x===0){hsla[i]=x;}});col.hsla=hsla;this._updateUI(fromEditor);if(this.onChange){this.onChange(col);}}},{key:'_updateUI',value:function _updateUI(fromEditor){if(!this.domElement){return;}
      var col=this.colour,hsl=col.hsla,cssHue='hsl('+hsl[0]*HUES+', 100%, 50%)',cssHSL=col.hslString,cssHSLA=col.hslaString;var uiH=this._domH,uiSL=this._domSL,uiA=this._domA;function posX(parent,child,relX){child.style.left=relX*100+'%';}
      function posY(parent,child,relY){child.style.top=relY*100+'%';}
      posX(uiH,uiH.firstElementChild,hsl[0]);this._domSL.style.backgroundColor=this._domH.style.color=cssHue;posX(uiSL,uiSL.firstElementChild,hsl[1]);posY(uiSL,uiSL.firstElementChild,1-hsl[2]);uiSL.style.color=cssHSL;posY(uiA,uiA.firstElementChild,1-hsl[3]);var opaque=cssHSL,transp=opaque.replace('hsl','hsla').replace(')',', 0)'),bg='linear-gradient('+[opaque,transp]+')';this._domA.style.backgroundImage=bg+', '+BG_TRANSP;if(!fromEditor){var hex=col.hex;this._domEdit.value=this.settings.alpha?hex:hex.substr(0,7);}
      this._domSample.style.color=cssHSLA;}},{key:'_ifPopup',value:function _ifPopup(actionIf,actionElse){if(this.settings.parent&&this.settings.popup){actionIf&&actionIf(this.settings.popup);}else{actionElse&&actionElse();}}}]);return Picker;}();return Picker;})));
      </script>

  </body>
</html>
